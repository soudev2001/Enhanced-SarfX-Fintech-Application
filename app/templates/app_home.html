{% extends "app_base.html" %}

{% block content %}
<div class="wise-home animate-fade-in">
    <!-- Hero Section - Wise Style -->
    <section class="wise-hero">
        <div class="wise-hero-badge">
            <span class="wise-pulse-dot"></span>
            Taux en direct
        </div>
        <h1 class="wise-hero-title">
            Envoyez de l'argent<br/>
            <span class="wise-hero-highlight">au meilleur taux</span>
        </h1>
        <p class="wise-hero-subtitle">
            Comparez Western Union, Wise, et les banques marocaines en temps rÃ©el.
        </p>
    </section>

    <!-- Quick Convert Card - Wise Style -->
    <section class="wise-convert-card">
        <div class="wise-convert-header">
            <span class="wise-label">Vous envoyez</span>
            <div class="wise-live-badge">
                <span class="wise-live-dot"></span>
                Live
            </div>
        </div>
        
        <div class="wise-input-row">
            <input type="number" id="home-amount" value="1000" class="wise-amount-input" placeholder="1,000.00">
            <select id="home-from-currency" class="wise-currency-select">
                <option value="EUR">ðŸ‡ªðŸ‡º EUR</option>
                <option value="USD">ðŸ‡ºðŸ‡¸ USD</option>
                <option value="GBP">ðŸ‡¬ðŸ‡§ GBP</option>
                <option value="CHF">ðŸ‡¨ðŸ‡­ CHF</option>
            </select>
        </div>

        <div class="wise-rate-badge">
            <span class="wise-rate-icon">Ã—</span>
            <span class="wise-rate-value" id="home-rate">10.8245</span>
            <span class="wise-rate-label">Taux garanti</span>
        </div>

        <div class="wise-convert-header" style="margin-top: 16px;">
            <span class="wise-label">Le bÃ©nÃ©ficiaire reÃ§oit</span>
        </div>
        
        <div class="wise-result-row">
            <span class="wise-result-value" id="home-result">10,824.50</span>
            <span class="wise-result-currency">ðŸ‡²ðŸ‡¦ MAD</span>
        </div>

        <a href="{{ url_for('app.converter') }}" class="wise-cta-btn">
            Continuer <i data-lucide="arrow-right" style="width: 20px; height: 20px;"></i>
        </a>
    </section>

    <!-- Exchange Rate History - NEW -->
    <section class="wise-card">
        <div class="wise-card-header">
            <h2 class="wise-card-title">
                <i data-lucide="trending-up" style="width: 18px; height: 18px; color: var(--brand-primary);"></i>
                Historique des Taux
            </h2>
            <select id="history-period" class="wise-select-sm">
                <option value="7">7 jours</option>
                <option value="30">30 jours</option>
                <option value="90">3 mois</option>
            </select>
        </div>
        
        <div class="wise-chart-container" id="rate-history-chart"></div>

        <div class="wise-stats-grid">
            <div class="wise-stat-item">
                <span class="wise-stat-label">Actuel</span>
                <span class="wise-stat-value">10.82</span>
            </div>
            <div class="wise-stat-item">
                <span class="wise-stat-label">Max 7j</span>
                <span class="wise-stat-value wise-stat-up">10.90</span>
            </div>
            <div class="wise-stat-item">
                <span class="wise-stat-label">Min 7j</span>
                <span class="wise-stat-value wise-stat-down">10.78</span>
            </div>
            <div class="wise-stat-item">
                <span class="wise-stat-label">Variation</span>
                <span class="wise-stat-value wise-stat-up">+0.23%</span>
            </div>
        </div>
    </section>

    <!-- Providers Comparison - Enhanced -->
    <section class="wise-card">
        <div class="wise-card-header">
            <h2 class="wise-card-title">
                <i data-lucide="git-compare" style="width: 18px; height: 18px; color: var(--brand-primary);"></i>
                Comparer les Fournisseurs
            </h2>
        </div>

        <div class="wise-providers-list">
            <!-- Western Union -->
            <div class="wise-provider-item">
                <div class="wise-provider-logo" style="background: #FFCC00;">
                    <span style="color: #000; font-weight: 800; font-size: 11px;">WU</span>
                </div>
                <div class="wise-provider-info">
                    <span class="wise-provider-name">Western Union</span>
                    <span class="wise-provider-rate">1 EUR = <strong>10.72</strong> MAD</span>
                </div>
                <span class="wise-provider-badge wise-badge-slow">1-3j</span>
            </div>

            <!-- Wise - Best -->
            <div class="wise-provider-item wise-provider-best">
                <div class="wise-best-tag">Meilleur</div>
                <div class="wise-provider-logo" style="background: rgb(255 214 187);">
                    <span style="color: var(--wise-navy); font-weight: 800; font-size: 10px;">wise</span>
                </div>
                <div class="wise-provider-info">
                    <span class="wise-provider-name">Wise</span>
                    <span class="wise-provider-rate">1 EUR = <strong>10.82</strong> MAD</span>
                </div>
                <span class="wise-provider-badge wise-badge-fast">Instant</span>
            </div>

            <!-- Banque Populaire -->
            <div class="wise-provider-item">
                <div class="wise-provider-logo" style="background: #003366;">
                    {% if banks %}
                        {% for bank in banks if 'populaire' in bank.name|lower %}
                            {% if bank.logo %}
                            <img src="{{ bank.logo }}" alt="{{ bank.name }}" style="width: 100%; height: 100%; object-fit: contain; padding: 4px;">
                            {% else %}
                            <span style="color: #fff; font-weight: 700; font-size: 10px;">BP</span>
                            {% endif %}
                        {% else %}
                            <span style="color: #fff; font-weight: 700; font-size: 10px;">BP</span>
                        {% endfor %}
                    {% else %}
                    <span style="color: #fff; font-weight: 700; font-size: 10px;">BP</span>
                    {% endif %}
                </div>
                <div class="wise-provider-info">
                    <span class="wise-provider-name">Banque Populaire</span>
                    <span class="wise-provider-rate">1 EUR = <strong>10.65</strong> MAD</span>
                </div>
                <span class="wise-provider-badge wise-badge-medium">2-4j</span>
            </div>

            <!-- Attijariwafa -->
            <div class="wise-provider-item">
                <div class="wise-provider-logo" style="background: #E31837;">
                    {% if banks %}
                        {% for bank in banks if 'attijari' in bank.name|lower %}
                            {% if bank.logo %}
                            <img src="{{ bank.logo }}" alt="{{ bank.name }}" style="width: 100%; height: 100%; object-fit: contain; padding: 4px;">
                            {% else %}
                            <span style="color: #fff; font-weight: 700; font-size: 9px;">ATW</span>
                            {% endif %}
                        {% else %}
                            <span style="color: #fff; font-weight: 700; font-size: 9px;">ATW</span>
                        {% endfor %}
                    {% else %}
                    <span style="color: #fff; font-weight: 700; font-size: 9px;">ATW</span>
                    {% endif %}
                </div>
                <div class="wise-provider-info">
                    <span class="wise-provider-name">Attijariwafa Bank</span>
                    <span class="wise-provider-rate">1 EUR = <strong>10.68</strong> MAD</span>
                </div>
                <span class="wise-provider-badge wise-badge-medium">1-2j</span>
            </div>
        </div>

        <div class="wise-savings-banner">
            <i data-lucide="piggy-bank" style="width: 16px; height: 16px;"></i>
            Ã‰conomisez <strong>127 MAD</strong> avec SarfX sur 1000â‚¬
        </div>
    </section>

<!-- Wallet Summary - Compact -->
    {% if total_balance and total_balance.total_usd > 0 %}
    <section class="wise-wallet-card">
        <div class="wise-wallet-header">
            <div class="wise-wallet-icon">
                <i data-lucide="wallet" style="width: 20px; height: 20px;"></i>
            </div>
            <div class="wise-wallet-info">
                <span class="wise-wallet-label">Mon portefeuille</span>
                <span class="wise-wallet-total">${{ total_balance.total_usd | round(2) }}</span>
            </div>
            <a href="{{ url_for('app.profile') }}" class="wise-wallet-arrow">
                <i data-lucide="chevron-right" style="width: 20px; height: 20px;"></i>
            </a>
        </div>
        
        <div class="wise-wallet-currencies">
            {% for w in total_balance.wallets[:4] %}
            <div class="wise-currency-chip">
                <span class="wise-currency-flag">
                    {% if w.currency == 'USD' %}ðŸ‡ºðŸ‡¸{% elif w.currency == 'EUR' %}ðŸ‡ªðŸ‡º{% elif w.currency == 'MAD' %}ðŸ‡²ðŸ‡¦{% elif w.currency == 'GBP' %}ðŸ‡¬ðŸ‡§{% else %}ðŸ’±{% endif %}
                </span>
                <span class="wise-currency-amount">{{ w.balance | round(2) }}</span>
                <span class="wise-currency-code">{{ w.currency }}</span>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <!-- Banks Partners - Grid -->
    <section class="wise-card">
        <div class="wise-card-header">
            <h2 class="wise-card-title">
                <i data-lucide="landmark" style="width: 18px; height: 18px; color: var(--brand-primary);"></i>
                Banques Partenaires
            </h2>
        </div>

        <div class="wise-banks-grid">
            {% if banks and banks|length > 0 %}
                {% for bank in banks[:6] %}
                <div class="wise-bank-item">
                    {% if bank.logo %}
                    <img src="{{ bank.logo }}" alt="{{ bank.name }}" class="wise-bank-logo">
                    {% else %}
                    <div class="wise-bank-placeholder">{{ bank.name[:2] | upper }}</div>
                    {% endif %}
                    <span class="wise-bank-name">{{ bank.name }}</span>
                </div>
                {% endfor %}
            {% else %}
                <div class="wise-bank-item">
                    <img src="{{ url_for('static', filename='images/banks/attijariwafa.svg') }}" alt="Attijariwafa" class="wise-bank-logo">
                    <span class="wise-bank-name">Attijariwafa</span>
                </div>
                <div class="wise-bank-item">
                    <img src="{{ url_for('static', filename='images/banks/banque-populaire.svg') }}" alt="Banque Populaire" class="wise-bank-logo">
                    <span class="wise-bank-name">B. Populaire</span>
                </div>
                <div class="wise-bank-item">
                    <img src="{{ url_for('static', filename='images/banks/cih.svg') }}" alt="CIH" class="wise-bank-logo">
                    <span class="wise-bank-name">CIH Bank</span>
                </div>
                <div class="wise-bank-item">
                    <img src="{{ url_for('static', filename='images/banks/boa.svg') }}" alt="BOA" class="wise-bank-logo">
                    <span class="wise-bank-name">Bank of Africa</span>
                </div>
                <div class="wise-bank-item">
                    <img src="{{ url_for('static', filename='images/banks/bmci.svg') }}" alt="BMCI" class="wise-bank-logo">
                    <span class="wise-bank-name">BMCI</span>
                </div>
                <div class="wise-bank-item">
                    <img src="{{ url_for('static', filename='images/banks/albarid.svg') }}" alt="Al Barid" class="wise-bank-logo">
                    <span class="wise-bank-name">Al Barid</span>
                </div>
            {% endif %}
        </div>

        <p class="wise-banks-footer">
            <span class="wise-highlight">{{ banks|length if banks else 6 }}</span> banques â€¢ 
            <span class="wise-highlight">250+</span> distributeurs
        </p>
    </section>

    <!-- Recent Transactions -->
    {% if transactions and transactions|length > 0 %}
    <section class="wise-card">
        <div class="wise-card-header">
            <h2 class="wise-card-title">
                <i data-lucide="history" style="width: 18px; height: 18px; color: var(--brand-primary);"></i>
                ActivitÃ© RÃ©cente
            </h2>
            <a href="{{ url_for('app.transactions') }}" class="wise-link">Voir tout</a>
        </div>

        <div class="wise-transactions-list">
            {% for tx in transactions[:3] %}
            <div class="wise-tx-item">
                <div class="wise-tx-icon {{ 'wise-tx-out' if tx.type == 'send' else 'wise-tx-in' }}">
                    <i data-lucide="{{ 'arrow-up-right' if tx.type == 'send' else 'arrow-down-left' }}" style="width: 16px; height: 16px;"></i>
                </div>
                <div class="wise-tx-info">
                    <span class="wise-tx-name">{{ tx.recipient_name or tx.recipient or 'Transaction' }}</span>
                    <span class="wise-tx-date">{{ tx.created_at.strftime('%d/%m/%Y') if tx.created_at else 'Aujourd\'hui' }}</span>
                </div>
                <span class="wise-tx-amount {{ 'wise-tx-negative' if tx.type == 'send' else 'wise-tx-positive' }}">
                    {{ '-' if tx.type == 'send' else '+' }}{{ tx.amount or 0 }} {{ tx.from_currency or tx.currency or 'MAD' }}
                </span>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <!-- Features Grid -->
    <section class="wise-features-grid">
        <div class="wise-feature-item">
            <div class="wise-feature-icon" style="background: rgba(224, 90, 3, 0.1); color: var(--brand-primary);">
                <i data-lucide="zap" style="width: 24px; height: 24px;"></i>
            </div>
            <h3 class="wise-feature-title">Rapide</h3>
            <p class="wise-feature-desc">En quelques minutes</p>
        </div>
        <div class="wise-feature-item">
            <div class="wise-feature-icon" style="background: var(--success-bg); color: var(--success);">
                <i data-lucide="shield-check" style="width: 24px; height: 24px;"></i>
            </div>
            <h3 class="wise-feature-title">SÃ©curisÃ©</h3>
            <p class="wise-feature-desc">Cryptage bancaire</p>
        </div>
        <div class="wise-feature-item">
            <div class="wise-feature-icon" style="background: rgba(168, 85, 247, 0.1); color: #a855f7;">
                <i data-lucide="brain-circuit" style="width: 24px; height: 24px;"></i>
            </div>
            <h3 class="wise-feature-title">IA</h3>
            <p class="wise-feature-desc">PrÃ©dictions prÃ©cises</p>
        </div>
    </section>

    <!-- Main CTA -->
    <a href="{{ url_for('app.converter') }}" class="wise-main-cta">
        <span>Commencer maintenant</span>
        <i data-lucide="arrow-right" style="width: 20px; height: 20px;"></i>
    </a>
</div>

<style>
/* ==========================================
   WISE-INSPIRED DESIGN SYSTEM - HOME PAGE
   ========================================== */

/* Container */
.wise-home {
    display: flex;
    flex-direction: column;
    gap: 20px;
    padding-bottom: 100px;
}

/* Hero Section */
.wise-hero {
    padding: 20px 0 8px;
}

.wise-hero-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: var(--success-bg);
    color: var(--success);
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    margin-bottom: 16px;
}

.wise-pulse-dot {
    width: 8px;
    height: 8px;
    background: var(--success);
    border-radius: 50%;
    animation: pulse 2s infinite;
}

.wise-hero-title {
    font-size: 28px;
    font-weight: 800;
    line-height: 1.15;
    color: var(--text-primary);
    margin-bottom: 12px;
}

.wise-hero-highlight {
    background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.wise-hero-subtitle {
    font-size: 14px;
    color: var(--text-secondary);
    line-height: 1.5;
    max-width: 340px;
}

/* Convert Card */
.wise-convert-card {
    background: var(--surface);
    border: 1px solid var(--border-light);
    border-radius: 16px;
    padding: 20px;
    box-shadow: var(--shadow-card);
}

.wise-convert-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.wise-label {
    font-size: 11px;
    color: var(--text-tertiary);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.04em;
}

.wise-live-badge {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 11px;
    color: var(--success);
    font-weight: 700;
}

.wise-live-dot {
    width: 6px;
    height: 6px;
    background: var(--success);
    border-radius: 50%;
    animation: pulse 1.5s infinite;
}

.wise-input-row {
    display: flex;
    gap: 12px;
    align-items: center;
}

.wise-amount-input {
    flex: 1;
    font-size: 32px;
    font-weight: 700;
    border: none;
    background: transparent;
    color: var(--text-primary);
    padding: 8px 0;
    min-width: 0;
}

.wise-amount-input:focus {
    outline: none;
}

.wise-currency-select {
    background: var(--bg-tertiary);
    border: 1px solid var(--border-light);
    border-radius: 10px;
    padding: 12px 14px;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    cursor: pointer;
    min-width: 105px;
}

.wise-currency-select:focus {
    outline: none;
    border-color: var(--brand-primary);
}

.wise-rate-badge {
    display: flex;
    align-items: center;
    gap: 8px;
    background: var(--bg-secondary);
    border-radius: 10px;
    padding: 12px 14px;
    margin: 14px 0;
}

.wise-rate-icon {
    color: var(--text-tertiary);
    font-size: 14px;
}

.wise-rate-value {
    font-size: 15px;
    font-weight: 700;
    color: var(--success);
    font-family: 'Inter', monospace;
}

.wise-rate-label {
    font-size: 11px;
    color: var(--text-tertiary);
    margin-left: auto;
}

.wise-result-row {
    display: flex;
    align-items: baseline;
    gap: 10px;
    padding: 6px 0;
}

.wise-result-value {
    font-size: 34px;
    font-weight: 800;
    color: var(--text-primary);
    font-family: 'Inter', monospace;
}

.wise-result-currency {
    font-size: 15px;
    color: var(--text-secondary);
    font-weight: 600;
}

.wise-cta-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    background: var(--brand-primary);
    color: white;
    padding: 16px 24px;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 700;
    margin-top: 18px;
    transition: all 0.2s ease;
}

.wise-cta-btn:hover {
    background: var(--brand-primary-dark);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(224, 90, 3, 0.25);
}

/* Cards */
.wise-card {
    background: var(--surface);
    border: 1px solid var(--border-light);
    border-radius: 16px;
    padding: 18px;
    box-shadow: var(--shadow-card);
}

.wise-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 14px;
}

.wise-card-title {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 15px;
    font-weight: 700;
    color: var(--text-primary);
}

.wise-select-sm {
    background: var(--bg-tertiary);
    border: 1px solid var(--border-light);
    border-radius: 8px;
    padding: 6px 10px;
    font-size: 12px;
    color: var(--text-secondary);
}

.wise-link {
    font-size: 13px;
    font-weight: 600;
    color: var(--brand-primary);
}

/* Rate Chart */
.wise-chart-container {
    height: 160px;
    background: var(--bg-secondary);
    border-radius: 12px;
    margin-bottom: 14px;
}

.wise-stats-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
}

.wise-stat-item {
    text-align: center;
    padding: 10px 6px;
    background: var(--bg-secondary);
    border-radius: 10px;
}

.wise-stat-label {
    display: block;
    font-size: 10px;
    color: var(--text-tertiary);
    margin-bottom: 4px;
}

.wise-stat-value {
    font-size: 13px;
    font-weight: 700;
    color: var(--text-primary);
}

.wise-stat-up { color: var(--success); }
.wise-stat-down { color: var(--error); }

/* Providers */
.wise-providers-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.wise-provider-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px;
    background: var(--bg-secondary);
    border: 1px solid var(--border-light);
    border-radius: 12px;
    transition: all 0.2s ease;
    cursor: pointer;
    position: relative;
}

.wise-provider-item:hover {
    border-color: var(--brand-primary);
}

.wise-provider-best {
    border-color: var(--success);
    background: rgba(16, 185, 129, 0.04);
}

.wise-best-tag {
    position: absolute;
    top: -8px;
    right: 12px;
    background: var(--success);
    color: white;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 10px;
    font-weight: 700;
}

.wise-provider-logo {
    width: 42px;
    height: 42px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    overflow: hidden;
}

.wise-provider-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.wise-provider-name {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
}

.wise-provider-rate {
    font-size: 12px;
    color: var(--text-secondary);
}

.wise-provider-rate strong {
    color: var(--text-primary);
}

.wise-provider-badge {
    font-size: 10px;
    font-weight: 600;
    padding: 4px 8px;
    border-radius: 6px;
}

.wise-badge-fast {
    background: var(--success-bg);
    color: var(--success);
}

.wise-badge-medium {
    background: var(--warning-bg);
    color: var(--warning);
}

.wise-badge-slow {
    background: var(--bg-tertiary);
    color: var(--text-tertiary);
}

.wise-savings-banner {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-top: 14px;
    padding: 12px;
    background: var(--success-bg);
    border-radius: 10px;
    font-size: 12px;
    color: var(--success);
}

/* Wallet */
.wise-wallet-card {
    background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
    border-radius: 16px;
    padding: 18px;
    color: white;
}

.wise-wallet-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 14px;
}

.wise-wallet-icon {
    width: 40px;
    height: 40px;
    background: rgba(255,255,255,0.2);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.wise-wallet-info {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.wise-wallet-label {
    font-size: 11px;
    opacity: 0.8;
    text-transform: uppercase;
    letter-spacing: 0.04em;
}

.wise-wallet-total {
    font-size: 24px;
    font-weight: 800;
}

.wise-wallet-arrow {
    width: 36px;
    height: 36px;
    background: rgba(255,255,255,0.1);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.wise-wallet-currencies {
    display: flex;
    gap: 8px;
    overflow-x: auto;
    padding-bottom: 4px;
}

.wise-currency-chip {
    display: flex;
    align-items: center;
    gap: 6px;
    background: rgba(255,255,255,0.15);
    padding: 8px 12px;
    border-radius: 10px;
    flex-shrink: 0;
}

.wise-currency-flag { font-size: 16px; }
.wise-currency-amount { font-size: 14px; font-weight: 700; }
.wise-currency-code { font-size: 10px; opacity: 0.7; }

/* Banks Grid */
.wise-banks-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
}

.wise-bank-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    padding: 14px 10px;
    background: var(--bg-secondary);
    border: 1px solid var(--border-light);
    border-radius: 12px;
    transition: all 0.2s ease;
}

.wise-bank-item:hover {
    border-color: var(--brand-primary);
    transform: translateY(-2px);
}

.wise-bank-logo {
    width: 56px;
    height: 36px;
    object-fit: contain;
}

.wise-bank-placeholder {
    width: 56px;
    height: 36px;
    background: var(--border-light);
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 12px;
    color: var(--text-tertiary);
}

.wise-bank-name {
    font-size: 10px;
    color: var(--text-secondary);
    text-align: center;
    font-weight: 500;
}

.wise-banks-footer {
    text-align: center;
    margin-top: 12px;
    font-size: 12px;
    color: var(--text-tertiary);
}

.wise-highlight {
    font-weight: 700;
    color: var(--brand-primary);
}

/* Transactions */
.wise-transactions-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.wise-tx-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    background: var(--bg-secondary);
    border-radius: 10px;
}

.wise-tx-icon {
    width: 36px;
    height: 36px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.wise-tx-out {
    background: var(--error-bg);
    color: var(--error);
}

.wise-tx-in {
    background: var(--success-bg);
    color: var(--success);
}

.wise-tx-info {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.wise-tx-name {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
}

.wise-tx-date {
    font-size: 11px;
    color: var(--text-tertiary);
}

.wise-tx-amount {
    font-size: 14px;
    font-weight: 700;
}

.wise-tx-negative { color: var(--error); }
.wise-tx-positive { color: var(--success); }

/* Features */
.wise-features-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
}

.wise-feature-item {
    text-align: center;
    padding: 18px 10px;
    background: var(--surface);
    border: 1px solid var(--border-light);
    border-radius: 12px;
}

.wise-feature-icon {
    width: 48px;
    height: 48px;
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 10px;
}

.wise-feature-title {
    font-size: 12px;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 2px;
}

.wise-feature-desc {
    font-size: 10px;
    color: var(--text-tertiary);
}

/* Main CTA */
.wise-main-cta {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    background: linear-gradient(135deg, var(--brand-primary), var(--brand-primary-dark));
    color: white;
    padding: 18px 28px;
    border-radius: 14px;
    font-size: 16px;
    font-weight: 700;
    box-shadow: 0 6px 20px rgba(224, 90, 3, 0.25);
    transition: all 0.2s ease;
}

.wise-main-cta:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 28px rgba(224, 90, 3, 0.35);
}

/* Responsive */
@media (min-width: 640px) {
    .wise-hero-title { font-size: 36px; }
    .wise-providers-list {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
    }
    .wise-banks-grid { grid-template-columns: repeat(4, 1fr); }
}

@media (min-width: 1024px) {
    .wise-hero-title { font-size: 42px; }
    .wise-banks-grid { grid-template-columns: repeat(6, 1fr); }
}

/* Animation */
@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}
</style>

<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<script>
// Home Calculator
const homeAmount = document.getElementById('home-amount');
const homeFromCurrency = document.getElementById('home-from-currency');
const homeRate = document.getElementById('home-rate');
const homeResult = document.getElementById('home-result');

const rates = { 'EUR': 10.8245, 'USD': 10.0523, 'GBP': 12.6721, 'CHF': 11.2345 };

function formatNumber(num) {
    return num.toLocaleString('fr-FR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
}

function updateHomeCalc() {
    const amount = parseFloat(homeAmount.value) || 0;
    const currency = homeFromCurrency.value;
    const rate = rates[currency] || 10.8245;
    homeRate.textContent = rate.toFixed(4);
    homeResult.textContent = formatNumber(amount * rate);
}

homeAmount.addEventListener('input', updateHomeCalc);
homeFromCurrency.addEventListener('change', updateHomeCalc);
updateHomeCalc();

// Rate Chart
const chartEl = document.getElementById('rate-history-chart');
if (chartEl) {
    const chart = new ApexCharts(chartEl, {
        series: [{ name: 'EUR/MAD', data: [10.75, 10.78, 10.82, 10.79, 10.85, 10.81, 10.82] }],
        chart: { type: 'area', height: 160, toolbar: { show: false }, background: 'transparent', zoom: { enabled: false } },
        colors: ['#e05a03'],
        fill: { type: 'gradient', gradient: { shadeIntensity: 1, opacityFrom: 0.4, opacityTo: 0.05 } },
        stroke: { curve: 'smooth', width: 2 },
        grid: { borderColor: 'var(--border-light)', strokeDashArray: 3, padding: { left: 10, right: 10 } },
        xaxis: { categories: ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'], labels: { style: { colors: '#8492a6', fontSize: '10px' } }, axisBorder: { show: false }, axisTicks: { show: false } },
        yaxis: { labels: { style: { colors: '#8492a6', fontSize: '10px' }, formatter: val => val.toFixed(2) } },
        tooltip: { theme: 'dark', y: { formatter: val => val.toFixed(4) + ' MAD' } },
        dataLabels: { enabled: false }
    });
    chart.render();
}
</script>
{% endblock %}
