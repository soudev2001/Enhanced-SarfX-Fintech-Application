{% extends "auth/login.html" %}

{% block title %}Nouveau mot de passe - SarfX{% endblock %}

{% block auth_content %}
<div class="text-center mb-6">
    <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-500 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg">
        <i data-lucide="key-round" style="width: 32px; height: 32px; color: white;"></i>
    </div>
    <h2 class="text-xl font-bold" style="color: var(--text-primary);">
        Nouveau mot de passe
    </h2>
    <p class="text-sm mt-1" style="color: var(--text-secondary);">
        Pour {{ email }}
    </p>
</div>

<form method="POST" action="{{ url_for('auth.reset_password', token=token) }}" class="flex flex-col gap-4">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <div class="flex flex-col gap-3">
        <div class="input-group">
            <div class="relative">
                <i data-lucide="lock" style="position: absolute; left: 16px; top: 50%; transform: translateY(-50%); width: 20px; height: 20px; color: var(--text-tertiary);"></i>
                <input type="password" name="password" id="password"
                       class="input"
                       style="padding-left: 48px; padding-right: 48px;"
                       placeholder="Nouveau mot de passe"
                       required
                       minlength="6"
                       autocomplete="new-password">
                <button type="button" onclick="togglePassword('password')" style="position: absolute; right: 16px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: var(--text-tertiary);" aria-label="Afficher/masquer le mot de passe">
                    <i data-lucide="eye" id="eye-icon-password" style="width: 20px; height: 20px;"></i>
                </button>
            </div>
        </div>
        <div class="input-group">
            <div class="relative">
                <i data-lucide="lock" style="position: absolute; left: 16px; top: 50%; transform: translateY(-50%); width: 20px; height: 20px; color: var(--text-tertiary);"></i>
                <input type="password" name="password_confirm" id="password_confirm"
                       class="input"
                       style="padding-left: 48px; padding-right: 48px;"
                       placeholder="Confirmer le mot de passe"
                       required
                       minlength="6"
                       autocomplete="new-password">
                <button type="button" onclick="togglePassword('password_confirm')" style="position: absolute; right: 16px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: var(--text-tertiary);" aria-label="Afficher/masquer le mot de passe">
                    <i data-lucide="eye" id="eye-icon-password_confirm" style="width: 20px; height: 20px;"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Password requirements -->
    <div class="text-xs" style="color: var(--text-secondary);">
        <p>Le mot de passe doit contenir :</p>
        <ul class="list-disc list-inside mt-1">
            <li>Au moins 6 caractères</li>
        </ul>
    </div>

    <button type="submit" class="btn btn-gradient btn-lg btn-block">
        Réinitialiser le mot de passe
        <i data-lucide="check" style="width: 20px; height: 20px;"></i>
    </button>
</form>

<script>
function togglePassword(fieldId) {
    const field = document.getElementById(fieldId);
    const icon = document.getElementById('eye-icon-' + fieldId);
    if (field.type === 'password') {
        field.type = 'text';
        icon.setAttribute('data-lucide', 'eye-off');
    } else {
        field.type = 'password';
        icon.setAttribute('data-lucide', 'eye');
    }
    if (typeof lucide !== 'undefined') {
        lucide.createIcons();
    }
}
</script>
{% endblock %}
